<!DOCTYPE html>
<html>
<head>
  <title>Books</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<div class="container">

  <div class="d-flex justify-content-between mb-3">
    <h3>Book List</h3>
    <a href="add.html" class="btn btn-success">âž• Add Book</a>
  </div>

  <table class="table table-bordered table-striped">
    <thead class="table-dark">
      <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="table"></tbody>
  </table>

</div>

<script>
const API = "http://127.0.0.1:8000/api/books/";

fetch(API)
.then(res => res.json())
.then(data => {
  let rows = "";
  data.forEach(b => {
    rows += `
      <tr>
        <td>${b.title}</td>
        <td>${b.author}</td>
        <td>${b.publish_date}</td>
        <td>
          <a href="view.html?id=${b.id}" class="btn btn-info btn-sm">View</a>
          <a href="edit.html?id=${b.id}" class="btn btn-warning btn-sm">Edit</a>
          <button class="btn btn-danger btn-sm" onclick="del(${b.id})">Delete</button>
        </td>
      </tr>`;
  });
  table.innerHTML = rows;
});

function del(id) {
  if (!confirm("Delete this book?")) return;
  fetch(API + id + "/", { method: "DELETE" })
  .then(() => location.reload());
}
</script>
</body>
</html>
